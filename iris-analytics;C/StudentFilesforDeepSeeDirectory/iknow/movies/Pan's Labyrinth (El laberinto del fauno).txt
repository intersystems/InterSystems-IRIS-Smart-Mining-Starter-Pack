An unseen narrator tells a fairy tale: In a magic underground realm, a young princess is curious about life on the surface world. She escapes to the world above, but is blinded by the sun. Her memory erased, she dies. Her father the king believes that she will return one day in another time and place.

In Spain, 1944, the Spanish Civil War has been over for five years and the fascist Francisco Franco is in power. However, small groups of guerrilla rebels camp in the wilderness to fight the fascist military authorities. Ten-year-old Ofelia (Ivana Baquero) moves to Navarra with her mother Carmen (Ariadna Gil). Ofelia's father had died in the war, and Carmen is now married to Captain Vidal (Sergi López), a sadistic Fascist officer of Francisco Franco's army, and Carmen is heavily pregnant with his child. Vidal is under orders to rid the territory of the remaining few leftist rebels hiding in the forest. Upon their arrival at Vidal's base (an old mill), Ofelia wanders into the nearby woods and discovers an ancient stone labyrinth. Vidal's housekeeper, Mercedes (Maribel Verdu), advises Ofelia to stay away from the labyrinth and takes her back to her mother.

Carmen is either unaware of or enduring the fact that her husband is a cruel man of war. She loves her daughter, but does not understand Ofelia's passion for fairy tales and her intricate imagination. Carmen is in delicate health due to her difficult pregnancy, and she is tended to by the kind Dr. Ferraro (Alex Angulo), who is stationed with Vidal. In the middle of the night, Ofelia is visited by a large insect she had encountered during the trip to the mill. It morphs into a tiny fairy and leads the girl outside to the labyrinth. At the heart of the stone structure, Ofelia meets a faun (Doug Jones), half man, half goat, who informs her that she is the princess of the underground realm that was lost long ago. He presents her with a magic book, explaining that she will be allowed to return to her kingdom if she follows the book's instructions and proves herself to be the true princess.

Vidal's men capture two "suspects" who they believe to be rebels. The two men, father and son, say they were simply hunting rabbits. When the son firmly defends this story, Vidal smashes his face in with a bottle and then shoots him. The father sobs and curses Vidal, and is shot through the head. Vidal then finds dead rabbits in their knapsack, proving that they were innocent. Showing no remorse, he blames his men for not searching for evidence properly.

Vidal soon holds a dinner party with several prominent figures of the community. For the occasion, Carmen presents Ofelia with a beautiful new dress and shoes. Ofelia then receives her first instructions from the magic book.For her first task, she miust kill a huge and grotesque toad who lives within a large hollow tree (which is slowly dying because of the toad inside) by getting three stones into its stomach. She then must retrieve a key from the dead toad's stomach. She does so, but she becomes filthy, ruining the pretty dress that her mother had brought especially for her to wear that evening for dinner, where she was to be formally introduced to the Captain and his guests. Her mother scolds her and she later is told off by Vidal.

When she looks at the book to learn her next task the pages turn blood red and she discovers her mother is hemorrhaging due to her difficult pregnancy. Ofelia gets help and her mother is put to bed, but the doctor reports that the outlook is grim. The Captain is certain the baby will be his male heir (implied that is because of his virility) and instructs the doctor to save the child and sacrifice the mother if necessary, an order Ofelia overhears.

The faun visits Ofelia and scolds her because she has not yet done the second task. Ofelia tells him that she's been tending to her ailing mother. To restore her mother's health, the faun gives Ofelia a mandrake root, which she secretly places in a bowl of milk under her mother's bed. The mandrake root appears to become a living miniature baby after it is placed in the milk and Ofelia adds a few drops of her own blood. The root has an instant effect on her mother, whose health improves greatly.

Ofelia's second task is to use the key to retrieve an object guarded by a dangerous creature with eyes in his hands, the Pale Man, who also feeds on children. Ofelia will be tempted by an array of food set out on a banquet table. The faun insists she must refrain from giving in to temptation and eating or touching any of the feast. To enter the Pale Man's lair, she uses a piece of magical chalk the faun gives her to draw a door. After retrieving what she was to get, an ornate dagger, she can't resist temptation, brushes off the fairies trying to warn her, and eats some grapes, waking the creature up. She barely succeeds in getting out alive. Ofelia gives the dagger to the faun, however, one of his fairies tells him of Ofelia's disobedience. Some of the fairies he had given her in a container to help her were eaten by the monster because of her recklessness. The faun admonishes her harshly and he tells her she'll never be worthy enough to return to her parent's realm.

Mercedes had given the keys of the storehouse where medicine and food are kept to her brother and friends. When one of the rebels (Iván Massagué) is captured, Vidal tortures him. The Captain wants the doctor to revive the prisoner so he can torture him some more. Instead, the doctor grants the prisoner's request and gives him a lethal dose of morphine, killing him so that he doesn't suffer anymore and won't reveal anything else. Vidal shoots the doctor in the back, having the final proof that he had been long supporting and helping the guerrillas.

The faun had instructed Ofelia that she had to regularly feed the mandrake root a drop of blood. While she does so, Vidal discovers Ofelia under Carmen's bed and pulls her out violently. He shows the mandrake root to his wife and leaves it with her. Carmen tells Ofelia that she's foolish to believe in magic and fairy tales and tosses the root in the fireplace. Carmen falls ill immediately. As the doctor is dead, a military medic delivers a baby boy, but Ofelia's mother dies.

Vidal takes the baby and keeps him in his chambers. Vidal slyly tricks Mercedes into revealing that she has been helping the guerrillas. Mercedes tries to leave in the middle of the night; she bids goodbye to Ophelia, whom begs her to take her along. Mercedes refuses a first, but does so and they are both captured immediately by Vidal. Vidal has Ophelia locked in her room and orders her to be closely watched. He also orders his men to kill the girl first if anyone tries to free her.

Vidal has Mercedes hands bound and gathers his instruments of torture. Mercedes, using a small paring knife she conceals in her apron, cuts her bonds, and stabs the Captain in the back and in his shoulder and sticks the blade in his mouth. She tells him to be careful because she "knows how to gut a pig", slashes his cheek open and heads for the woods. She is pursued by one of Vidal's lieutenants and a small detachment of men who find her. Mercedes threatens to cut her own throat when her brother and his men appear and kill Vidal's men. Mercedes joins them, but is determined to rescue Ofelia and her little brother from Vidal.

Ofelia is visited again by the faun, who has decided to give her another chance. Her third task is to bring her baby brother to the labyrinth. Ofelia uses the enchanted chalk given to her by the faun to enter Vidal's room undetected. At the moment she sneaks into Vidal's room to get the baby, the rebels make a final attack. Ofelia sneaks into the Captain's room where he is suturing his cheek himself. He discovers Ofelia but she grabs her baby brother and runs to the forest and into the labyrinth with him in her arms, followed by Vidal. Ofelia stops when reaching the labyrinth, where the faun, holding a dagger, tells her to give him her brother because some blood from an innocent is needed for her to become the princess again. Ofelia, not wanting her brother to be harmed in any way, refuses to hand him over.

Vidal sees her with the baby in her arms talking to the wind. He takes the infant from Ofelia's arms and then proceeds to shoot her, leaving her for dead.

When Vidal turns back toward the buildings, he sees he is surrounded by Mercedes with a large number of armed guerrilla warriors behind her. They take the baby from him. Vidal looks at the watch his own father had broken on his deathbed to record the time of his death (which Vidal had repaired.) He asks Mercedes to tell the baby boy about his father, how dutiful he had been, and about the watch. Mercedes tells him the baby will never know who his father was. The rebels kill Vidal at the moment he realizes his child will be raised as one of those people he hates.

Mercedes tries to aid the dying Ofelia, but to no avail: her eyes are open and she is apparently dead. Her blood drips down to the pit where the portal to the fairytale world is located, and she gives a final smile. The sun seemingly rises and bathes her in a golden light, taking her into a beautiful court surrounded by people. There Ofelia's kingly father tells her that spilling her own blood rather than that of her infant brother was how the third task is actually completed. The faun also appears, telling her she made the right choice; the queenly mother, who resembles Ophelia's mortal mother, tells her to take her rightful place beside her father for they've waited a long time for the princess' return. Around her, the court applauds as the fairytale world becomes revitalized again, and the narrator tells us that the princess ruled for long years beloved by all.

But at the labyrinth where Ofelia's body lies, Mercedes only sees the final smile before the girl dies. Mercedes weep for the loss of innocence while behind her, the rebels tend to the baby.

The ending gives the audience multiple theories to consider. One is that Ofelia did indeed reclaim her throne and became the princess she had so wished for. The other theory is that the whole story was her imagination, and that the fairytale world never existed in the first place. A third theory is that the fairytale world did exist, but after Ofelia refused to sacrifice her brother, the portal was forever lost to her and she only imagined her redemption so that she could die happy. 